#!/usr/bin/env node

const yarg = require('yargs');
const path = require('path');

const package = require('../package.json');
const { ACTION } = require('../config/static');
const { commands } = require('../config/static');

const launcher = options => require('../index')(options);

yarg.usage('$0 <command> [options]');

Object.keys(commands).forEach(action => {
  yarg.command(
    commands[action].command,
    commands[action].description,
    yargs => {
      yargs.positional('name', {
        type: 'string',
        default: 'none',
        describe: ''
      });
    },
    argv => {
      launcher(
        Object.assign(
          {
            params: { name: argv.name, jssdk: !!argv.j, isCurrDir: argv.name === 'none' },
            version: package.version
          },
          ACTION[action]
        )
      );
    }
  );
});

yarg
  .help('h')
  .alias('h', 'help')
  .version(package.version)
  .alias('v', 'version')
  .demandCommand().argv;
